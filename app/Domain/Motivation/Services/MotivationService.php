<?php

namespace App\Domain\Motivation\Services;

use App\Domain\Motivation\Contracts\MotivationProviderInterface;
use App\Domain\Motivation\Enums\MotivationType;

class MotivationService
{
    public function __construct(
        private MotivationProviderInterface $provider
    ) {}

    public function generateMessage(?MotivationType $type = null): string
    {
        $type = $type ?? $this->getRandomType();

        $message = $this->provider->generate($type);

        if ($message === null) {
            return $this->getFallbackMessage($type);
        }

        return $message;
    }

    private function getRandomType(): MotivationType
    {
        $types = MotivationType::cases();
        return $types[array_rand($types)];
    }

    private function getFallbackMessage(MotivationType $type): string
    {
        $messages = match($type) {
            MotivationType::MOTIVATIONAL => [
                'Твои задачи ждут не дождутся, когда ты их наконец выполнишь!',
                'Сегодня ты будешь продуктивнее, чем вчера. Или хотя бы попробуешь.',
                'Каждая выполненная задача - это маленькая победа над прокрастинацией.',
                'Дедлайн - это не угроза, это мотивация с обратным отсчетом.',
                'Твоя продуктивность сегодня будет как кофе без сахара - горькая, но бодрящая.',
                'Помни: даже самый длинный список задач начинается с одной галочки.',
                'Сегодня отличный день, чтобы доказать вчерашнему себе, что он был неправ.',
            ],
            MotivationType::JOKE => [
                'Почему задачи размножаются ночью? Потому что ты их не закрываешь!',
                'Программист решил задачу во сне. Проснулся и понял, что это был кошмар.',
                'Лучший способ выполнить задачу - добавить ее в список "Выполнено" вручную.',
                'Задача выполнена, когда она удалена из списка. Или когда ты забыл о ней.',
                'Если задача не решается, добавь еще 10 задач - первая покажется простой.',
                'Дедлайн - это не дата, это настроение.',
                'Прокрастинация - это искусство откладывать задачи до тех пор, пока они не станут срочными.',
                'Зачем делать сегодня то, что можно отложить на завтра? Завтра можно отложить на послезавтра!',
            ],
            MotivationType::FACT => [
                'Люди наиболее продуктивны в первые 2 часа после пробуждения. Остальное время - иллюзия.',
                'Перерывы каждые 90 минут повышают продуктивность. Или просто оправдывают прокрастинацию.',
                'Записывание задач освобождает память. И создает новый список задач для запоминания.',
                'Многозадачность снижает продуктивность на 40%. Но зато создает иллюзию занятости.',
                'Утренняя рутина определяет успех дня. Если ты вообще проснулся - уже победа.',
                'Средний человек проверяет телефон 150 раз в день. И все еще удивляется, почему ничего не успевает.',
                'Прокрастинация - это не лень, это стратегия оптимизации стресса.',
            ],
            MotivationType::QUOTE => [
                'Успех - это сумма маленьких усилий, которые ты откладывал до последнего момента.',
                'Лучшее время посадить дерево было 20 лет назад. Второе лучшее время - когда вспомнишь об этом.',
                'Не откладывай на завтра то, что можно сделать сегодня. Отложи на послезавтра - у тебя будет больше времени.',
                'Путь в тысячу миль начинается с одного шага. И заканчивается тысячей отговорок.',
                'Трудности - это возможности в рабочей одежде. Или просто трудности, если честно.',
                'Время - деньги. Но деньги не возвращают время. Зато можно купить кофе.',
                'Перфекционизм - это прокрастинация в маске продуктивности.',
            ],
        };

        return $messages[array_rand($messages)];
    }
}

